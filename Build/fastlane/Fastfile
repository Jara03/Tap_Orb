default_platform(:ios)

platform :ios do
  desc "Build and upload to TestFlight (CI)"
  lane :beta do

    # ðŸ” Use already-initialized certificates & profiles
    match(
      type: "appstore",
      readonly: true
    )

increment_build_number(
  xcodeproj: "Unity-iPhone.xcodeproj"
)

    # ðŸ— Build the Xcode project generated by Unity
build_app(
  scheme: "Unity-iPhone",
  project: "Unity-iPhone.xcodeproj",
  export_method: "app-store",
  clean: true,
  export_options: {
    signingStyle: "manual",
    teamID: "X2LW2Y6K56",
    provisioningProfiles: {
      "com.alliumstudio.taporb" => "match AppStore com.alliumstudio.taporb"
    }
  }
)


    # ðŸš€ Upload to TestFlight
    upload_to_testflight(
      skip_waiting_for_build_processing: true
    )
  end
end
